@import url("https://fonts.cdnfonts.com/css/general-sans");

@tailwind base;
@tailwind components;
@tailwind utilities;

body {
  width: 100dvw;
  overflow-x: hidden;
  background-color: #dfdff0;
  font-family: "General Sans", sans-serif;
  -webkit-overflow-scrolling: touch;
  overscroll-behavior-y: none;
}

/* Smooth scroll behavior */
html {
  scroll-behavior: smooth;
}

/* Prevent zoom on mobile */
@media (max-width: 768px) {
  body {
    touch-action: pan-y;
  }
  
  input, textarea, select {
    font-size: 16px !important;
  }
}

@layer base {
  @font-face {
    font-family: "circular-web";
    src: url("/fonts/circularweb-book.woff2") format("woff2");
  }

  @font-face {
    font-family: "general";
    src: url("/fonts/general.woff2") format("woff2");
  }

  @font-face {
    font-family: "robert-medium";
    src: url("/fonts/robert-medium.woff2") format("woff2");
  }

  @font-face {
    font-family: "robert-regular";
    src: url("/fonts/robert-regular.woff2") format("woff2");
  }

  @font-face {
    font-family: "zentry";
    src: url("/fonts/zentry-regular.woff2") format("woff2");
  }

  /* Knight Warrior OTF for the KHEL.FUN logo */
  @font-face {
    font-family: "KnightWarrior";
    src: url("/fonts/KnightWarrior.otf") format("opentype");
    font-weight: 700;
    font-style: normal;
    font-display: swap;
  }
}

@layer utilities {
  .border-hsla {
    @apply border border-white/20;
  }

  .nav-hover-btn {
    @apply relative ms-10 font-general text-xs uppercase text-blue-50 after:absolute after:-bottom-0.5 after:left-0 after:h-[2px] after:w-full after:origin-bottom-right after:scale-x-0 after:bg-neutral-800 after:transition-transform after:duration-300 after:ease-[cubic-bezier(0.65_0.05_0.36_1)] hover:after:origin-bottom-left hover:after:scale-x-100 dark:after:bg-white cursor-pointer;
  }

  .nav-hover-btn-enhanced {
    @apply relative px-4 py-2 font-general text-sm uppercase text-white cursor-pointer overflow-hidden rounded-lg transition-all duration-300;
    animation: fadeInDown 0.5s ease-out forwards;
    opacity: 0;
    /* stronger translucent pill for contrast */
    background: rgba(8, 10, 20, 0.14);
    backdrop-filter: blur(8px) saturate(120%);
    -webkit-backdrop-filter: blur(8px) saturate(120%);
    padding-left: 14px;
    padding-right: 14px;
    border-radius: 12px;
    border: 1px solid rgba(255,255,255,0.06);
    box-shadow: 0 6px 18px rgba(0,0,0,0.12);
  }

  .nav-hover-btn-enhanced:hover {
    @apply text-white;
    background: rgba(255,255,255,0.08);
    box-shadow: 0 10px 30px rgba(87, 36, 255, 0.12);
  }

  /* Make primary CTA stand out more (PLAY NOW) using a small enhancement.
     This targets the button inside the nav which uses the .nav-hover-btn-enhanced
     utility for links and the Button component for the CTA. */
  .nav-cta-enhanced {
    background: linear-gradient(90deg, #7C3AED, #6EE7B7);
    color: white !important;
    padding: 8px 18px;
    border-radius: 9999px;
    box-shadow: 0 10px 30px rgba(124,58,237,0.18);
    transition: transform 180ms ease, box-shadow 180ms ease;
  }
  .nav-cta-enhanced:active { transform: translateY(1px) scale(0.995); }

  .nav-link-text {
    @apply relative z-10 transition-transform duration-300;
  }

  .nav-hover-btn-enhanced:hover .nav-link-text {
    transform: translateY(-2px);
  }

  .nav-link-glow {
    @apply absolute inset-0 -z-10 opacity-0 transition-opacity duration-300;
    background: linear-gradient(90deg, transparent, rgba(87, 36, 255, 0.4), transparent);
    transform: translateX(-100%);
  }

  .nav-hover-btn-enhanced:hover .nav-link-glow {
    animation: slideGlow 0.8s ease-in-out;
    opacity: 1;
  }

  @keyframes fadeInDown {
    from {
      opacity: 0;
      transform: translateY(-10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes slideGlow {
    0% {
      transform: translateX(-100%);
    }
    100% {
      transform: translateX(100%);
    }
  }

  .floating-nav {
   /* Keep floating-nav visually lightweight: transparent base + backdrop blur.
     Remove any gradient or heavy box-shadow so the nav doesn't leave a dark strip. */
   background: transparent;
   border-radius: 9999px; /* match pill shape */
   border: 1px solid rgba(255,255,255,0.04);
   backdrop-filter: blur(10px) saturate(120%);
   -webkit-backdrop-filter: blur(10px) saturate(120%);
   box-shadow: none;
  /* Improve rendering stability when the nav is being transformed/animated.
    Promote to its own layer and hint the browser to composite this element
    separately so subpixel hairlines and repaint artifacts are minimized. */
  will-change: transform, opacity, backdrop-filter;
  transform: translateZ(0);
  -webkit-transform: translateZ(0);
  -webkit-backface-visibility: hidden;
  backface-visibility: hidden;
  background-clip: padding-box; /* prevent border bleeding/artifacts */
  }

  /* When the floating-nav modifier is present, neutralize the inner header
    border to avoid stacked 1px borders showing as thin lines during scroll
    and slightly soften the shadow so it looks consistent while floating. */
  .floating-nav header {
   border-color: transparent !important;
   box-shadow: 0 8px 28px rgba(0,0,0,0.06) !important;
   -webkit-backdrop-filter: blur(12px) saturate(120%);
   backdrop-filter: blur(12px) saturate(120%);
   background-clip: padding-box;
  }

  /* Explicitly remove any border on the header to avoid a thin white
     hairline appearing when the navbar transitions or when classes toggle. */
  .site-nav-header {
    border: none !important;
    border-color: transparent !important;
    box-shadow: 0 8px 28px rgba(0,0,0,0.06) !important;
    background-clip: padding-box;
  }

  .absolute-center {
    @apply absolute top-1/2 left-1/2 translate-x-[-50%] translate-y-[-50%];
  }

  .flex-center {
    @apply flex justify-center items-center;
  }

  .mask-clip-path {
    clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%);
  }

  .special-font b {
    font-family: "Zentry";
    font-feature-settings: "ss01" on;
  }

  .hero-heading {
    @apply uppercase font-zentry font-black text-5xl sm:right-10 sm:text-7xl md:text-9xl lg:text-[12rem];
  }

  .hero-heading-glow {
    text-shadow: 
      0 0 10px rgba(87, 36, 255, 0.5),
      0 0 20px rgba(87, 36, 255, 0.3),
      0 0 30px rgba(87, 36, 255, 0.2);
    animation: pulse-glow 2s ease-in-out infinite;
  }

  .about-subtext {
    @apply absolute bottom-[-80dvh] left-1/2 w-full max-w-96 -translate-x-1/2 text-center font-circular-web text-lg md:max-w-[34rem];
  }

  .about-image {
    @apply absolute left-1/2 top-0 z-20 h-[60vh] w-96 origin-center -translate-x-1/2 overflow-hidden rounded-3xl md:w-[30vw];
  }

  .animated-title {
    @apply flex flex-col gap-1 text-7xl uppercase leading-[.8] text-white sm:px-32 md:text-[6rem];
  }

  .animated-word {
    @apply special-font font-zentry font-black opacity-0;
    /* Keep words inline and only offset vertically before animation.
       Removing heavy 3D transforms prevents the slanted/overflow behaviour. */
    transform: translate3d(0px, 30px, 0px) rotateY(0deg) rotateX(0deg) translateZ(0);
    transform-origin: 50% 50%;
    will-change: opacity, transform;
    display: inline-block;
  }

  .bento-tilt_1 {
    @apply relative border-hsla col-span-2 overflow-hidden rounded-md transition-transform duration-300 ease-out;
  }

  .bento-tilt_2 {
    @apply relative col-span-1 row-span-1 overflow-hidden rounded-md transition-transform duration-300 ease-out;
  }

  .bento-tilt_1::before,
  .bento-tilt_2::before {
    content: "";
    position: absolute;
    inset: 0;
    background: linear-gradient(
      135deg,
      transparent 0%,
      rgba(87, 36, 255, 0.1) 50%,
      transparent 100%
    );
    opacity: 0;
    transition: opacity 0.3s ease;
    pointer-events: none;
    z-index: 10;
  }

  .bento-tilt_1:hover::before,
  .bento-tilt_2:hover::before {
    opacity: 1;
  }

  .bento-tilt_1:hover,
  .bento-tilt_2:hover {
    box-shadow: 
      0 0 20px rgba(87, 36, 255, 0.3),
      0 0 40px rgba(87, 36, 255, 0.2),
      inset 0 0 20px rgba(87, 36, 255, 0.1);
    border-color: rgba(87, 36, 255, 0.6);
  }

  /* Zunno Card Special Purple Glow - Only on Hover */
  .zunno-glow-card {
    border: 2px solid rgba(87, 36, 255, 0.2);
    transition: all 0.3s ease;
  }

  @media (hover: hover) and (pointer: fine) {
    .zunno-glow-card:hover {
      border-color: rgba(87, 36, 255, 0.8);
      box-shadow: 
        0 0 40px rgba(87, 36, 255, 0.6),
        0 0 80px rgba(87, 36, 255, 0.3),
        0 0 120px rgba(87, 36, 255, 0.2),
        inset 0 0 40px rgba(87, 36, 255, 0.2);
    }
  }

  .bento-title {
    @apply uppercase md:text-6xl text-4xl font-black font-zentry;
  }

  .story-img-container {
    @apply relative md:h-dvh h-[90vh] w-full;
    filter: url("#flt_tag");
  }

  .story-img-mask {
    @apply absolute left-0 top-0 size-full overflow-hidden md:left-[20%] md:top-[-10%] md:size-4/5;
    clip-path: polygon(4% 0, 83% 21%, 100% 73%, 0% 100%);
  }

  .story-img-content {
    @apply absolute w-full md:h-dvh h-[50dvh] opacity-100 left-10 top-16 md:left-0 md:top-10 lg:left-[-300px] lg:top-[-100px];
    transform: translate3d(0, 0, 0) rotateX(0) rotateY(0) rotateZ(0) scale(1);
  }

  .gallery-img-container {
    @apply size-64 overflow-hidden bg-violet-300;
  }

  .gallery-img {
    @apply size-full bg-cover;
  }

  .gallery-img-4 {
    @apply sm:size-80 md:h-96 md:w-[25rem] rounded-lg;
  }

  .cube-grid-container {
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    width: 40vw;
    height: 40vw;
    max-width: 500px;
    max-height: 500px;
    border-radius: 20px;
    overflow: visible;
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    grid-template-rows: repeat(4, 1fr);
    gap: 4px;
    perspective: 1500px;
    transform-style: preserve-3d;
  }

  .cube-piece {
    position: relative;
    width: 100%;
    height: 100%;
    background-size: 400% 400%;
    border-radius: 8px;
    box-shadow: 
      0 4px 15px rgba(87, 36, 255, 0.2),
      inset 0 0 20px rgba(0, 0, 0, 0.1);
    transform-style: preserve-3d;
    will-change: transform, opacity;
    transition: box-shadow 0.3s ease;
    -webkit-backface-visibility: hidden;
    backface-visibility: hidden;
    transform: translateZ(0);
    border: 1px solid rgba(255, 255, 255, 0.1);
  }

  .cube-piece::before {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(
      135deg,
      rgba(87, 36, 255, 0.15) 0%,
      transparent 50%,
      rgba(79, 183, 221, 0.15) 100%
    );
    border-radius: 8px;
    opacity: 0.5;
    mix-blend-mode: overlay;
    animation: shimmer 3s ease-in-out infinite;
    animation-delay: calc(var(--row) * 0.1s + var(--col) * 0.1s);
  }

  .cube-piece::after {
    content: '';
    position: absolute;
    inset: -2px;
    background: linear-gradient(
      45deg,
      rgba(87, 36, 255, 0.5),
      rgba(79, 183, 221, 0.5)
    );
    border-radius: 8px;
    opacity: 0;
    filter: blur(10px);
    z-index: -1;
    transition: opacity 0.3s ease;
  }

  @keyframes shimmer {
    0%, 100% {
      opacity: 0.3;
    }
    50% {
      opacity: 0.7;
    }
  }

  @media (max-width: 768px) {
    .cube-grid-container {
      width: 70vw;
      height: 70vw;
      perspective: 800px;
    }
    
    .cube-piece {
      border-radius: 4px;
      gap: 2px;
    }

    /* Disable 3D transforms on mobile for better performance */
    .bento-tilt_1,
    .bento-tilt_2 {
      transform: none !important;
    }

    /* Optimize video performance on mobile */
    video {
      transform: translateZ(0);
      -webkit-backface-visibility: hidden;
      backface-visibility: hidden;
    }

    /* Reduce animation complexity on mobile */
    .cube-piece {
      will-change: transform, opacity;
      transform: translateZ(0);
    }

    /* Improve touch targets */
    .nav-hover-btn-enhanced {
      min-height: 44px;
      padding: 12px 16px;
    }

    /* Prevent text selection issues */
    .bento-title,
    .special-font {
      -webkit-user-select: none;
      user-select: none;
      -webkit-touch-callout: none;
    }
  }

  .sword-man-clip-path {
    clip-path: polygon(16% 0, 89% 15%, 75% 100%, 0 97%);
  }

  .contact-clip-path-1 {
    clip-path: polygon(25% 0%, 74% 0, 69% 64%, 34% 73%);
  }

  .contact-clip-path-2 {
    clip-path: polygon(29% 15%, 85% 30%, 50% 100%, 10% 64%);
  }
}

.indicator-line {
  @apply h-2 w-px rounded-full transition-all duration-200 ease-in-out;
  background: linear-gradient(180deg, #5724FF, #4FB7DD);
}

.indicator-line.active {
  animation: indicator-line 0.5s ease infinite;
  animation-delay: calc(var(--animation-order) * 0.1s);
  box-shadow: 0 0 8px rgba(87, 36, 255, 0.8);
}

@keyframes indicator-line {
  0% {
    height: 4px;
    transform: translateY(-0px);
  }
  50% {
    height: 16px;
    transform: translateY(-4px);
  }
  100% {
    height: 4px;
    transform: translateY(-0px);
  }
}

/* From Uiverse.io by G4b413l */
/* https://uiverse.io/G4b413l/tidy-walrus-92 */
.three-body {
  --uib-size: 35px;
  --uib-speed: 0.8s;
  --uib-color: #5d3fd3;
  position: relative;
  display: inline-block;
  height: var(--uib-size);
  width: var(--uib-size);
  animation: spin78236 calc(var(--uib-speed) * 2.5) infinite linear;
}

.three-body__dot {
  position: absolute;
  height: 100%;
  width: 30%;
}

.three-body__dot:after {
  content: "";
  position: absolute;
  height: 0%;
  width: 100%;
  padding-bottom: 100%;
  background-color: var(--uib-color);
  border-radius: 50%;
}

.three-body__dot:nth-child(1) {
  bottom: 5%;
  left: 0;
  transform: rotate(60deg);
  transform-origin: 50% 85%;
}

.three-body__dot:nth-child(1)::after {
  bottom: 0;
  left: 0;
  animation: wobble1 var(--uib-speed) infinite ease-in-out;
  animation-delay: calc(var(--uib-speed) * -0.3);
}

.three-body__dot:nth-child(2) {
  bottom: 5%;
  right: 0;
  transform: rotate(-60deg);
  transform-origin: 50% 85%;
}

.three-body__dot:nth-child(2)::after {
  bottom: 0;
  left: 0;
  animation: wobble1 var(--uib-speed) infinite calc(var(--uib-speed) * -0.15)
    ease-in-out;
}

.three-body__dot:nth-child(3) {
  bottom: -5%;
  left: 0;
  transform: translateX(116.666%);
}

.three-body__dot:nth-child(3)::after {
  top: 0;
  left: 0;
  animation: wobble2 var(--uib-speed) infinite ease-in-out;
}

@keyframes spin78236 {
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
}

@keyframes wobble1 {
  0%,
  100% {
    transform: translateY(0%) scale(1);
    opacity: 1;
  }

  50% {
    transform: translateY(-66%) scale(0.65);
    opacity: 0.8;
  }
}

@keyframes wobble2 {
  0%,
  100% {
    transform: translateY(0%) scale(1);
    opacity: 1;
  }

  50% {
    transform: translateY(66%) scale(0.65);
    opacity: 0.8;
  }
}

@keyframes pulse-glow {
  0%, 100% { 
    text-shadow: 
      0 0 10px rgba(87, 36, 255, 0.5),
      0 0 20px rgba(87, 36, 255, 0.3);
  }
  50% { 
    text-shadow: 
      0 0 20px rgba(87, 36, 255, 0.8),
      0 0 40px rgba(87, 36, 255, 0.5),
      0 0 60px rgba(87, 36, 255, 0.3);
  }
}

@keyframes grid-move {
  0% {
    transform: translate(0, 0);
  }
  100% {
    transform: translate(4rem, 4rem);
  }
}

.animate-pulse-slow {
  animation: pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite;
}

/* K.F mask used in the intro: large letters filled with the BG image */
.kf-mask-wrapper {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 100%;
}

.kf-mask {
  font-family:  "zentry", sans-serif;
  font-weight: 900;
  /* responsive large size */
  font-size: clamp(6rem, 20vw, 18rem);
  line-height: 0.9;
  text-transform: uppercase;
  letter-spacing: -0.02em;
  color: transparent;
  /* show background image inside the letters - keep the image fixed relative to the viewport
     so the letters move independently while the artwork appears stationary */
  background-image: url('/bg.png');
  background-size: cover;
  background-position: center center;
  background-attachment: fixed;
  background-repeat: no-repeat;
  -webkit-background-clip: text;
  background-clip: text;
  display: inline-block;
  transform-origin: 50% 50%;
  /* add a subtle inner shadow to make edges crisp on dark bg */
  filter: drop-shadow(0 2px 0 rgba(0,0,0,0.6));
}


.animate-grid-move {
  animation: grid-move 20s linear infinite;
}

/* Ensure hero panorama fills the viewport without extra gutters
   - force the landing section to be full-bleed
   - make image layers cover and anchor to the top so the artwork crops/zooms to fill
   These rules are scoped to the hero classes and won't affect other components. */
.landing {
  margin: 0 !important;
  padding: 0 !important;
  width: 100vw !important;
  height: 100vh !important;
  left: 0;
  top: 0;
}

.imagesdiv {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  overflow: hidden;
}

.imagesdiv img.sky,
.imagesdiv img.bg {
  position: absolute !important;
  /* expand slightly and nudge to the top-left so the image fills and covers corners */
  left: 0% !important;
  top: -6% !important;
  width: 140% !important;
  height: auto !important;
  object-fit: cover !important;
  object-position: left top !important; /* anchor to top-left */
  display: block !important;
  transform-origin: left top;
}

.imagesdiv img.character {
  /* keep character sizing/positioning but ensure it doesn't introduce layout gaps */
  max-width: 100vw;
  height: auto;
}

/* Restore original card hover effects */
.bento-tilt_1 {
  @apply relative border-hsla col-span-2 overflow-hidden rounded-md transition-all duration-500 ease-[cubic-bezier(0.25,0.46,0.45,0.94)];
  will-change: transform, box-shadow, border-color;
  transform: translateZ(0);
  backface-visibility: hidden;
}

.bento-tilt_2 {
  @apply relative col-span-1 row-span-1 overflow-hidden rounded-md transition-all duration-500 ease-[cubic-bezier(0.25,0.46,0.45,0.94)];
  will-change: transform, box-shadow, border-color;
  transform: translateZ(0);
  backface-visibility: hidden;
}

.bento-tilt_1::before,
.bento-tilt_2::before {
  content: "";
  position: absolute;
  inset: 0;
  background: linear-gradient(
    135deg,
    transparent 0%,
    rgba(87, 36, 255, 0.1) 50%,
    transparent 100%
  );
  opacity: 0;
  transition: opacity 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
  pointer-events: none;
  z-index: 10;
}

.bento-tilt_1:hover::before,
.bento-tilt_2:hover::before {
  opacity: 1;
}

.bento-tilt_1:hover,
.bento-tilt_2:hover {
  transform: translateZ(0) scale(1.02);
  box-shadow: 
    0 0 30px rgba(87, 36, 255, 0.4),
    0 0 60px rgba(87, 36, 255, 0.3),
    0 0 90px rgba(87, 36, 255, 0.2),
    inset 0 0 30px rgba(87, 36, 255, 0.15);
  border-color: rgba(87, 36, 255, 0.8);
}

/* Zunno Card Special Purple Glow - Only on Hover */
.zunno-glow-card {
  border: 2px solid rgba(87, 36, 255, 0.2);
  transition: all 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
  will-change: transform, box-shadow, border-color;
  transform: translateZ(0);
  backface-visibility: hidden;
}

@media (hover: hover) and (pointer: fine) {
  .zunno-glow-card:hover {
    transform: translateZ(0) scale(1.03);
    border-color: rgba(87, 36, 255, 0.9);
    box-shadow: 
      0 0 50px rgba(87, 36, 255, 0.7),
      0 0 100px rgba(87, 36, 255, 0.4),
      0 0 150px rgba(87, 36, 255, 0.3),
      0 0 200px rgba(87, 36, 255, 0.2),
      inset 0 0 50px rgba(87, 36, 255, 0.25);
  }

}

/* Smooth section transitions */
.section-transition {
  background: linear-gradient(180deg, 
    transparent 0%, 
    rgba(0, 0, 0, 0.1) 25%, 
    rgba(0, 0, 0, 0.3) 50%, 
    rgba(0, 0, 0, 0.6) 75%, 
    rgba(0, 0, 0, 1) 100%
  );
}